#!/usr/bin/env python
"""
Controller for various ports operations
"""

from port import ports, Port
from queue import ports_queue
#ports.port_filter = ports.Port.CURRENT | ports.Port.NEWER
ports.get('x11/xorg')
ports_queue.join()

for name, port in ports.iteritems():
  print """
==============================================================================
Origin:      %s
------------------------------------------------------------------------------
Name:        %s
Version:     %s
Revision:    %s
Comment:     ``%s''
Dependants:  %s
Depend stat: %i
""" % (name, port.attr('name'), port.attr('version'),
       port.attr('revision'), port.attr('comment'),
       str([[i[0] for i in j] for j in port.depends()._dependants]),
       port.depends().status())

import make
make.pre_target = ['echo']

for i in ports.itervalues():
  if i.stage() < Port.CONFIG:
    i.config()

print ports_queue.stats(), len(ports)
